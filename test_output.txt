node.exe : PASS __tes
ts__/meeting-type/mee
ting-type.test.ts
At C:\Program Files\n
odejs\npx.ps1:29 
char:3
+   & $NODE_EXE 
$NPX_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~
    + CategoryInfo   
           : NotSpe  
  cified: (PASS __   
 tests__/...ng-ty    
pe.test.ts:Strin    
g) [], RemoteExc    
eption
    + FullyQualified 
   ErrorId : Native  
  CommandError
 
  Meeting Type API
    GET 
/api/meeting-type
      ΓêÜ returns 
empty when no 
company_id (19 ms)
      ΓêÜ fetches 
types scoped to 
company_id (5 ms)
    POST 
/api/meeting-type
      ΓêÜ returns 
400 when name is 
missing (3 ms)
      ΓêÜ creates 
meeting type with 
company_id from JWT 
(3 ms)
    PUT 
/api/meeting-type
      ΓêÜ updates 
meeting type by id 
(3 ms)
    DELETE 
/api/meeting-type
      ΓêÜ returns 
400 when id is 
missing (2 ms)
      ΓêÜ deletes 
meeting type by id 
(7 ms)

PASS __tests__/securi
ty/tenant-isolation.t
est.ts
  Multi-Tenant 
Isolation Security
    All GET routes 
use company_id from 
JWT header, NOT 
request
      ΓêÜ Staff: 
Company 2 admin 
query uses 
company_id=2, not 1 
(17 ms)
      ΓêÜ Meetings: 
Company 2 cannot see 
Company 1 meetings 
(3 ms)
      ΓêÜ Meeting 
Types: Company 2 
only sees its own 
types (3 ms)
      ΓêÜ Action 
Items: Company 2 
only sees its own 
items (2 ms)
      ΓêÜ Dashboard: 
Company 2 stats 
scoped correctly (7 
ms)
    Backend ignores 
request-body 
injected company_id
      ΓêÜ POST 
Staff: injected 
company_id in body 
is ignored (9 ms)
      ΓêÜ POST 
Meeting Type: 
injected company_id 
in body is ignored 
(3 ms)
      ΓêÜ POST 
Action Item: 
injected company_id 
in body is ignored 
(3 ms)
      ΓêÜ POST 
Meeting: injected 
company_id in body 
is ignored 
(transaction) (3 ms)
    IDOR Protection 
via company-scoped 
queries
      ΓêÜ Querying 
action items with 
foreign meetingId 
still scoped by 
company_id (2 ms)
    Horizontal 
privilege escalation 
prevention
      ΓêÜ MEMBER 
from Company 2 
cannot query Company 
1 staff (1 ms)
      ΓêÜ MEMBER 
from Company 1 data 
is isolated from 
Company 2 dashboard 
(3 ms)

PASS __tests__/profil
e/profile.test.ts
  Profile API
    GET /api/profile
      ΓêÜ returns 
401 when x-user-id 
is missing (19 ms)
      ΓêÜ returns 
404 when user not 
found (3 ms)
      ΓêÜ returns 
user profile with 
stats for tenant 
users (6 ms)
    PUT /api/profile
      ΓêÜ returns 
401 when x-user-id 
is missing (3 ms)
      ΓêÜ hashes 
password when 
updating (8 ms)

PASS __tests__/regist
ration/registration.t
est.ts
  POST 
/api/registration
    ΓêÜ returns 400 
when required fields 
are missing (25 ms)
    ΓêÜ returns 409 
when registration 
email already exists 
(3 ms)
    ΓêÜ returns 409 
when email is 
already a user (3 ms)
    ΓêÜ hashes 
password and creates 
request on success 
(4 ms)

PASS __tests__/auth/r
egister.test.ts
  POST 
/api/auth/register
    ΓêÜ returns 400 
when required fields 
are missing (21 ms)
    ΓêÜ returns 409 
when email already 
exists (3 ms)
    ΓêÜ hashes 
password before 
storing (7 ms)
    ΓêÜ returns user 
data and token on 
success (3 ms)

PASS __tests__/securi
ty/enterprise-hardeni
ng.test.ts
  Enterprise 
Hardening ΓÇö Token 
Security
    Token tampering 
detection
      ΓêÜ rejects 
token signed with 
wrong secret (28 ms)
      ΓêÜ rejects 
completely invalid 
Base64 token (3 ms)
      ΓêÜ rejects 
token with no 
payload segment (1 
ms)
      ΓêÜ rejects 
token with corrupted 
payload (2 ms)
    Expired token 
handling
      ΓêÜ middleware 
still processes 
expired tokens 
(decode-only, no 
verify) (3 ms)
    Role escalation 
attempts
      ΓêÜ MEMBER 
token cannot access 
SUPER_ADMIN routes 
even if manually 
crafted (3 ms)
      ΓêÜ 
COMPANY_ADMIN cannot 
access SUPER_ADMIN 
panel (3 ms)
      ΓêÜ crafted 
token with unknown 
role is still 
processed 
(middleware decode) 
(3 ms)
      ΓêÜ crafted 
token with 
SUPER_ADMIN role but 
company_id cannot 
access tenant routes 
(4 ms)
    SUPER_ADMIN 
isolation boundaries
      ΓêÜ 
SUPER_ADMIN blocked 
from tenant route: 
/api/meetings (3 ms)
      ΓêÜ 
SUPER_ADMIN blocked 
from tenant route: 
/api/staff (3 ms)
      ΓêÜ 
SUPER_ADMIN blocked 
from tenant route: 
/api/meeting-type (3 
ms)
      ΓêÜ 
SUPER_ADMIN blocked 
from tenant route: 
/api/action-items (6 
ms)
      ΓêÜ 
SUPER_ADMIN blocked 
from tenant route: 
/api/dashboard/stats 
(2 ms)
      ΓêÜ 
SUPER_ADMIN blocked 
from tenant route: 
/api/attendance/1 (2 
ms)
      ΓêÜ 
SUPER_ADMIN allowed 
on: /api/super-admin/
stats (2 ms)
      ΓêÜ 
SUPER_ADMIN allowed 
on: /api/super-admin/
companies (2 ms)
      ΓêÜ 
SUPER_ADMIN allowed 
on: /api/super-admin/
registrations (2 ms)
      ΓêÜ 
SUPER_ADMIN allowed 
on: /api/auth/login 
(2 ms)
      ΓêÜ 
SUPER_ADMIN allowed 
on: /api/profile (3 
ms)
    company_id null 
enforcement for 
tenant routes
      ΓêÜ 
COMPANY_ADMIN with 
null company_id is 
blocked from tenant 
APIs (2 ms)
      ΓêÜ MEMBER 
with undefined 
company_id is 
blocked (2 ms)

PASS __tests__/dashbo
ard/stats.test.ts
  GET 
/api/dashboard/stats
    ΓêÜ returns 
empty stats when no 
company_id 
(SUPER_ADMIN) (19 ms)
    ΓêÜ returns 
stats scoped to 
company_id for 
COMPANY_ADMIN (13 ms)
    ΓêÜ applies 
role-based filtering 
for MEMBER (4 ms)

PASS __tests__/integr
ation/lifecycle.test.
ts
  Integration: Full 
Company Lifecycle
    ΓêÜ skipped ΓÇö 
set 
INTEGRATION_TESTS=1 
to run (1 ms)

PASS __tests__/middle
ware/middleware.test.
ts
  Middleware
    Public routes
      ΓêÜ allows 
/login without auth 
(20 ms)
      ΓêÜ allows 
/register-company 
without auth (2 ms)
      ΓêÜ allows 
/forgot-password 
without auth (2 ms)
      ΓêÜ allows 
/reset-password 
without auth (2 ms)
      ΓêÜ allows 
/api/auth/login 
without auth (2 ms)
      ΓêÜ allows 
/api/registration 
without auth (2 ms)
      ΓêÜ allows 
root page / (2 ms)
    Missing token
      ΓêÜ returns 
401 for API routes 
without token (4 ms)
      ΓêÜ redirects 
page routes to 
/login without token 
(4 ms)
    Invalid token
      ΓêÜ returns 
401 for malformed 
token on API routes 
(2 ms)
      ΓêÜ redirects 
to login for 
malformed token on 
page routes (1 ms)
    SUPER_ADMIN 
route protection
      ΓêÜ blocks 
COMPANY_ADMIN from 
/super-admin routes 
(8 ms)
      ΓêÜ blocks 
MEMBER from 
/api/super-admin 
routes (2 ms)
      ΓêÜ allows 
SUPER_ADMIN to 
access /super-admin 
routes (3 ms)
    SUPER_ADMIN 
cannot access tenant 
routes
      ΓêÜ blocks 
SUPER_ADMIN from 
/api/meetings (3 ms)
      ΓêÜ blocks 
SUPER_ADMIN from 
/api/staff (3 ms)
      ΓêÜ blocks 
SUPER_ADMIN from 
/dashboard page 
(redirects to 
/super-admin) (2 ms)
      ΓêÜ allows 
SUPER_ADMIN to 
access /api/auth 
routes (2 ms)
      ΓêÜ allows 
SUPER_ADMIN to 
access /api/profile 
(6 ms)
    company_id 
enforcement
      ΓêÜ blocks 
tenant API access 
when user has no 
company_id (3 ms)
      ΓêÜ allows 
tenant API access 
when user has 
company_id (2 ms)
    Header forwarding
      ΓêÜ sets 
x-user-id, 
x-user-role, 
x-company-id headers 
(1 ms)
      ΓêÜ sets empty 
x-company-id for 
SUPER_ADMIN (2 ms)
    Authorization 
header
      ΓêÜ accepts 
token from Bearer 
header (2 ms)

PASS __tests__/auth/r
eset-password.test.ts
  POST /api/auth/rese
t-password
    ΓêÜ returns 400 
when token is 
missing (17 ms)
    ΓêÜ returns 400 
when password is 
missing (2 ms)
    ΓêÜ returns 400 
when token is 
invalid or expired 
(3 ms)
    ΓêÜ verifies 
token is checked 
with expiry gt: 
now() (4 ms)
    ΓêÜ hashes new 
password and clears 
reset token on 
success (5 ms)
    ΓêÜ returns 500 
on unexpected error 
(3 ms)

PASS __tests__/auth/l
ogin.test.ts
  POST 
/api/auth/login
    ΓêÜ returns 400 
when email or 
password is missing 
(15 ms)
    ΓêÜ returns 401 
when user does not 
exist (1 ms)
    ΓêÜ returns 401 
when password is 
wrong (2 ms)
    ΓêÜ returns 403 
when company is 
suspended (2 ms)
    ΓêÜ returns 403 
when company is 
soft-deleted (2 ms)
    ΓêÜ allows 
SUPER_ADMIN login 
even without active 
company (6 ms)
    ΓêÜ returns 
token and user data 
on successful login 
(2 ms)
    ΓêÜ includes 
company_id in JWT 
payload (2 ms)

PASS __tests__/meetin
gs/meetings.test.ts
  Meetings API
    GET /api/meetings
      ΓêÜ returns 
empty array for 
users without 
company_id (12 ms)
      ΓêÜ returns 
meetings scoped to 
company_id for 
COMPANY_ADMIN (3 ms)
      ΓêÜ filters by 
created_by/meeting_me
mber for MEMBER role 
(2 ms)
    POST 
/api/meetings
      ΓêÜ returns 
403 for MEMBER role 
(2 ms)
      ΓêÜ returns 
400 when required 
fields are missing 
(1 ms)
      ΓêÜ creates 
meeting via 
transaction with 
company_id from JWT 
(3 ms)
      ΓêÜ sets 
company_id from 
header, ignoring 
body-provided 
company_id (4 ms)

PASS __tests__/staff/
staff.test.ts
  Staff API
    GET /api/staff
      ΓêÜ fetches 
staff scoped to 
company_id from 
middleware (21 ms)
      ΓêÜ enforces 
company_id ΓÇö 
Company 2 admin 
cannot see Company 1 
staff (2 ms)
    POST /api/staff
      ΓêÜ returns 
400 when staff name 
is missing (3 ms)
      ΓêÜ creates 
staff with 
company_id from JWT, 
not request body (3 
ms)
      ΓêÜ creates a 
linked user login 
when email is 
provided (3 ms)
    DELETE /api/staff
      ΓêÜ returns 
400 when id is 
missing (2 ms)
      ΓêÜ deletes 
staff by id (1 ms)

  console.log
    ---------------------------------------------------

      at POST (app/api/auth/forgot-password/route.ts:43:17)

  console.log
    PASSWORD RESET LINK FOR: test@company.com

      at POST (app/api/auth/forgot-password/route.ts:44:17)

  console.log
    http://localhost:3000/reset-password?token=ec75bf393e05b57059bf947728580cb612ae7201246679078c761c0fe02a2ab3

      at POST (app/api/auth/forgot-password/route.ts:45:17)

  console.log
    ---------------------------------------------------

      at POST (app/api/auth/forgot-password/route.ts:46:17)

PASS __tests__/auth/f
orgot-password.test.t
s
  POST /api/auth/forg
ot-password
    ΓêÜ returns 400 
when email is 
missing (18 ms)
    ΓêÜ returns 200 
even if user does 
not exist (security) 
(3 ms)
    ΓêÜ stores reset 
token when user 
exists (52 ms)

PASS __tests__/action
-items/action-items.t
est.ts
  Action Items API
    GET 
/api/action-items
      ΓêÜ fetches 
action items scoped 
to company_id (12 ms)
      ΓêÜ filters by 
staffId when 
provided (1 ms)
    POST 
/api/action-items
      ΓêÜ returns 
400 when description 
or meetingId is 
missing (2 ms)
      ΓêÜ creates 
action item with 
company_id from JWT 
(1 ms)

  console.error
    Registration action error: Error: Company "New Corp" already exists
        at C:\Users\avnil\OneDrive\Desktop\AWT Project\mom_management\app\api\super-admin\registrations\route.ts:95:23
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 157 |[39m         })
     [90m 158 |[39m     } [36mcatch[39m (error[33m:[39m any) {
    [31m[1m>[22m[39m[90m 159 |[39m         console[33m.[39merror([32m'Registration action error:'[39m[33m,[39m error)
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 160 |[39m         [36mreturn[39m [33mNextResponse[39m[33m.[39mjson(
     [90m 161 |[39m             { message[33m:[39m error[33m.[39mmessage [33m||[39m [32m'Failed to process registration'[39m }[33m,[39m
     [90m 162 |[39m             { status[33m:[39m [35m500[39m }[0m

      at PUT (app/api/super-admin/registrations/route.ts:159:17)
      at Object.<anonymous> (__tests__/super-admin/super-admin.test.ts:229:25)

  console.error
    Registration action error: Error: User with email "jane@newcorp.com" already exists
        at C:\Users\avnil\OneDrive\Desktop\AWT Project\mom_management\app\api\super-admin\registrations\route.ts:103:23
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at PUT (C:\Users\avnil\OneDrive\Desktop\AWT Project\mom_management\app\api\super-admin\registrations\route.ts:89:24)
        at Object.<anonymous> (C:\Users\avnil\OneDrive\Desktop\AWT Project\mom_management\__tests__\super-admin\super-admin.test.ts:254:25)

    [0m [90m 157 |[39m         })
     [90m 158 |[39m     } [36mcatch[39m (error[33m:[39m any) {
    [31m[1m>[22m[39m[90m 159 |[39m         console[33m.[39merror([32m'Registration action error:'[39m[33m,[39m error)
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 160 |[39m         [36mreturn[39m [33mNextResponse[39m[33m.[39mjson(
     [90m 161 |[39m             { message[33m:[39m error[33m.[39mmessage [33m||[39m [32m'Failed to process registration'[39m }[33m,[39m
     [90m 162 |[39m             { status[33m:[39m [35m500[39m }[0m

      at PUT (app/api/super-admin/registrations/route.ts:159:17)
      at Object.<anonymous> (__tests__/super-admin/super-admin.test.ts:254:25)

PASS __tests__/super-
admin/super-admin.tes
t.ts
  Super Admin API
    GET /api/super-ad
min/companies
      ΓêÜ returns 
all active companies 
with counts (18 ms)
    PUT /api/super-ad
min/companies
      ΓêÜ returns 
400 for invalid 
status (4 ms)
      ΓêÜ suspends 
company and creates 
audit log (3 ms)
    GET /api/super-ad
min/registrations
      ΓêÜ fetches 
all registrations (2 
ms)
      ΓêÜ filters by 
status query param 
(2 ms)
    PUT /api/super-ad
min/registrations 
ΓÇö Reject
      ΓêÜ returns 
400 for invalid 
action (6 ms)
      ΓêÜ returns 
404 when request not 
found (3 ms)
      ΓêÜ rejects 
already-processed 
request (2 ms)
      ΓêÜ rejects 
request and creates 
audit log (4 ms)
    PUT /api/super-ad
min/registrations 
ΓÇö Approve 
(Transaction)
      ΓêÜ approves 
request via 
transaction: creates 
company, user, audit 
log (3 ms)
      ΓêÜ rolls back 
transaction when 
company name already 
exists (57 ms)
      ΓêÜ rolls back 
transaction when 
email already exists 
as user (6 ms)
    GET /api/super-ad
min/stats
      ΓêÜ returns 
aggregated platform 
statistics (1 ms)

PASS __tests__/securi
ty/audit-logging.test
.ts
  Audit & Logging 
Validation
    Company status 
change audit trails
      ΓêÜ creates 
audit log with 
SUSPEND_COMPANY 
action (11 ms)
      ΓêÜ creates 
audit log with 
ACTIVATE_COMPANY 
action (1 ms)
    Registration 
rejection audit trail
      ΓêÜ logs 
REJECT_REGISTRATION 
with reason in 
metadata (2 ms)
    Registration 
approval audit trail
      ΓêÜ creates 
audit log inside 
transaction on 
approval (1 ms)
    Audit log cannot 
be bypassed
      ΓêÜ audit 
creation is always 
called even when 
main operation 
succeeds (2 ms)

PASS __tests__/staff/
staff-detail.test.ts
  Staff [id] API
    PUT 
/api/staff/:id
      ΓêÜ returns 
400 for non-numeric 
ID (8 ms)
      ΓêÜ updates 
staff name (3 ms)
      ΓêÜ updates 
email, mobile, and 
remarks together (1 
ms)
      ΓêÜ only 
includes defined 
fields in update (2 
ms)
      ΓêÜ returns 
500 on database 
error (1 ms)
    DELETE 
/api/staff/:id
      ΓêÜ returns 
400 for non-numeric 
ID (1 ms)
      ΓêÜ deletes 
staff by ID 
(cascade) (1 ms)
      ΓêÜ returns 
500 when staff not 
found (1 ms)

PASS __tests__/action
-items/action-item-de
tail.test.ts
  Action Items [id] 
API
    PUT 
/api/action-items/:id
      ΓêÜ updates 
isCompleted field 
(10 ms)
      ΓêÜ updates 
assignedTo field 
(null clears 
assignment) (1 ms)
      ΓêÜ updates 
description and 
dueDate together (1 
ms)
      ΓêÜ always 
includes updated_at 
in data (1 ms)
      ΓêÜ includes 
assignee in response 
(1 ms)
      ΓêÜ returns 
500 on database 
error (1 ms)
    DELETE 
/api/action-items/:id
      ΓêÜ deletes 
action item by ID (1 
ms)
      ΓêÜ returns 
500 when item does 
not exist (1 ms)

PASS __tests__/meetin
gs/meeting-detail.tes
t.ts
  Meetings 
[meetingId] API
    GET /api/meetings
/:meetingId
      ΓêÜ returns 
400 for non-numeric 
ID (7 ms)
      ΓêÜ returns 
404 when meeting not 
found (1 ms)
      ΓêÜ allows 
COMPANY_ADMIN to 
view any meeting (2 
ms)
      ΓêÜ allows 
creator to view 
their meeting (1 ms)
      ΓêÜ allows 
meeting admin to 
view the meeting (1 
ms)
      ΓêÜ allows 
invited member to 
view the meeting (1 
ms)
      ΓêÜ returns 
403 when MEMBER is 
not creator, admin, 
or invited (1 ms)
    PUT /api/meetings
/:meetingId
      ΓêÜ returns 
404 when meeting not 
found (2 ms)
      ΓêÜ returns 
403 when MEMBER is 
not creator or admin 
(1 ms)
      ΓêÜ allows 
creator to update 
meeting via 
transaction (1 ms)
      ΓêÜ handles 
cancellation data 
correctly
      ΓêÜ 
COMPANY_ADMIN can 
update any meeting 
(sys admin bypass)
    DELETE /api/meeti
ngs/:meetingId
      ΓêÜ deletes 
meeting by ID (2 ms)
      ΓêÜ returns 
500 when delete fails

Test Suites: 20 
passed, 20 total
Tests:       165 
passed, 165 total
Snapshots:   0 total
Time:        2.594 s
Ran all test suites.
